{"version":3,"file":"xmind-embed-viewer.js","mappings":"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","sources":["webpack://XMindEmbedViewer/webpack/universalModuleDefinition","webpack://XMindEmbedViewer/./src/channel-controller.ts","webpack://XMindEmbedViewer/./src/iframe-controller.ts","webpack://XMindEmbedViewer/webpack/bootstrap","webpack://XMindEmbedViewer/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"XMindEmbedViewer\"] = factory();\n\telse\n\t\troot[\"XMindEmbedViewer\"] = factory();\n})(self, () => {\nreturn ","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IframeEventChannelController = void 0;\nvar IframeEventChannelController = /** @class */ (function () {\n    function IframeEventChannelController(iFrameController, domain) {\n        if (domain === void 0) { domain = '*'; }\n        var _this = this;\n        this.channel = new MessageChannel();\n        this.eventIndex = 0;\n        this.handlers = {};\n        var iframe = iFrameController.getIframe();\n        if (iframe.hasAttribute('data-event-channel-setup')) {\n            throw new Error('An embed viewer instance already initialized on the iframe!');\n        }\n        else {\n            iframe.setAttribute('data-event-channel-setup', 'true');\n        }\n        this.channelSetupPromise = (function () { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, new Promise(function (resolve) {\n                            iframe.addEventListener('load', function () {\n                                var _a;\n                                _this.channel.port1.start();\n                                var port1Handler = function (e) {\n                                    var type = e.data[0];\n                                    if (type === 'channel-ready') {\n                                        e.preventDefault();\n                                        _this.channel.port1.removeEventListener('message', port1Handler);\n                                        _this.channel.port1.addEventListener('message', _this.eventDispatcher.bind(_this));\n                                        resolve(undefined);\n                                    }\n                                };\n                                _this.channel.port1.addEventListener('message', port1Handler);\n                                (_a = iframe.contentWindow) === null || _a === void 0 ? void 0 : _a.postMessage(['setup-channel', { port: _this.channel.port2 }], domain || '*', [_this.channel.port2]);\n                            });\n                        })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        }); })();\n    }\n    IframeEventChannelController.prototype.eventDispatcher = function (e) {\n        var _a = e.data || [], type = _a[0], eventName = _a[1], payload = _a[2];\n        if (type === 'event' && eventName && this.handlers[eventName]) {\n            this.handlers[eventName].forEach(function (handler) { return handler(payload); });\n        }\n    };\n    IframeEventChannelController.prototype.addEventListener = function (event, callback) {\n        this.handlers[event] = this.handlers[event] || [];\n        if (this.handlers[event].includes(callback))\n            return;\n        this.handlers[event].push(callback);\n    };\n    IframeEventChannelController.prototype.removeEventListener = function (event, callback) {\n        if (!this.handlers[event])\n            return;\n        var index = this.handlers[event].findIndex(function (fn) { return fn === callback; });\n        this.handlers[event].splice(index, 1);\n    };\n    IframeEventChannelController.prototype.emit = function (event, payload) {\n        return __awaiter(this, void 0, void 0, function () {\n            var replyEvent;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.channelSetupPromise];\n                    case 1:\n                        _a.sent();\n                        replyEvent = \"xmind-embed-viewer#\".concat(this.eventIndex++);\n                        return [4 /*yield*/, new Promise(function (resolve) {\n                                var handler = function (e) {\n                                    var _a = e.data, message = _a[0], payload = _a[1];\n                                    if (message === replyEvent) {\n                                        _this.channel.port1.removeEventListener('message', handler);\n                                        resolve(payload);\n                                    }\n                                };\n                                _this.channel.port1.addEventListener('message', handler);\n                                _this.channel.port1.postMessage([event, payload, replyEvent]);\n                            })];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return IframeEventChannelController;\n}());\nexports.IframeEventChannelController = IframeEventChannelController;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IframeController = void 0;\nvar IframeController = /** @class */ (function () {\n    function IframeController(target, src) {\n        var iframe;\n        var element = typeof target === 'string' ? document.querySelector(target) : target;\n        if (element === null) {\n            throw new Error('IFrame or mount element not found by selector ' + target);\n        }\n        if (element instanceof HTMLIFrameElement) {\n            iframe = element;\n        }\n        else {\n            iframe = document.createElement('iframe');\n            element.appendChild(iframe);\n        }\n        iframe.setAttribute('frameborder', '0');\n        iframe.setAttribute('scrolling', 'no');\n        iframe.setAttribute('allowfullscreen', 'true');\n        iframe.setAttribute('allow', 'allowfullscreen');\n        iframe.setAttribute('crossorigin', 'anonymous');\n        iframe.setAttribute('src', src);\n        this.iframe = iframe;\n    }\n    IframeController.prototype.getIframe = function () {\n        return this.iframe;\n    };\n    IframeController.prototype.setStyles = function (styles) {\n        var iframe = this.getIframe();\n        for (var _i = 0, _a = Object.entries(styles); _i < _a.length; _i++) {\n            var _b = _a[_i], styleKey = _b[0], value = _b[1];\n            // @ts-ignored\n            iframe.style[styleKey] = value;\n        }\n    };\n    return IframeController;\n}());\nexports.IframeController = IframeController;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.XMindEmbedViewer = void 0;\nvar channel_controller_1 = require(\"./channel-controller\");\nvar iframe_controller_1 = require(\"./iframe-controller\");\nvar XMindEmbedViewer = /** @class */ (function () {\n    /**\n     * Initialize a iframe element from a div/iframe html element.\n     */\n    function XMindEmbedViewer(args) {\n        var _this = this;\n        this.internalState = {\n            sheets: [],\n            zoomScale: 100,\n            currentSheetId: ''\n        };\n        var file = args.file, el = args.el, _a = args.region, region = _a === void 0 ? 'global' : _a, _b = args.styles, styles = _b === void 0 ? {\n            'height': '350px',\n            'width': '750px',\n        } : _b, isPitchModeDisabled = args.isPitchModeDisabled;\n        var domain = region === 'cn' ? 'www.xmind.cn' : 'www.xmind.app';\n        var iframeController = new iframe_controller_1.IframeController(el, \"https://\".concat(domain, \"/embed-viewer\").concat(isPitchModeDisabled ? '?pitch-mode=disabled' : ''));\n        var iframeEventChannelController = new channel_controller_1.IframeEventChannelController(iframeController, \"https://\".concat(domain));\n        this.iframeController = iframeController;\n        this.iframeEventChannelController = iframeEventChannelController;\n        this.region = region;\n        iframeEventChannelController.addEventListener('sheet-switch', function (payload) { return _this.internalState.currentSheetId = payload; });\n        iframeEventChannelController.addEventListener('zoom-change', function (payload) { return _this.internalState.zoomScale = payload; });\n        iframeEventChannelController.addEventListener('sheets-load', function (payload) { return _this.internalState.sheets = payload; });\n        this.iframeController.setStyles(styles);\n        if (file) {\n            this.load(file);\n        }\n    }\n    /**\n     * Add event listener for embed viewer.\n     *\n     * Available events:\n     * - map-ready\n     * - zoom-change\n     * - sheet-switch\n     * - sheets-load\n     *\n     */\n    XMindEmbedViewer.prototype.addEventListener = function (event, callback) {\n        this.iframeEventChannelController.addEventListener(event, callback);\n    };\n    XMindEmbedViewer.prototype.removeEventListener = function (event, callback) {\n        this.iframeEventChannelController.removeEventListener(event, callback);\n    };\n    /**\n     * Update styles for created iframe element.\n     */\n    XMindEmbedViewer.prototype.setStyles = function (styles) {\n        this.iframeController.setStyles(styles);\n    };\n    /**\n     * Load a file for embed viewer after iframe ready.\n     */\n    XMindEmbedViewer.prototype.load = function (file) {\n        this.iframeEventChannelController.emit('open-file', file);\n    };\n    XMindEmbedViewer.prototype.setZoomScale = function (zoomScale) {\n        this.iframeEventChannelController.emit('zoom', zoomScale);\n    };\n    XMindEmbedViewer.prototype.setFitMap = function () {\n        this.iframeEventChannelController.emit('fit-map');\n    };\n    XMindEmbedViewer.prototype.switchSheet = function (sheetId) {\n        this.iframeEventChannelController.emit('switch-sheet', sheetId);\n    };\n    Object.defineProperty(XMindEmbedViewer.prototype, \"zoom\", {\n        get: function () {\n            return this.internalState.zoomScale;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(XMindEmbedViewer.prototype, \"sheets\", {\n        get: function () {\n            return JSON.parse(JSON.stringify(this.internalState.sheets));\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(XMindEmbedViewer.prototype, \"currentSheetId\", {\n        get: function () {\n            return this.internalState.currentSheetId;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return XMindEmbedViewer;\n}());\nexports.XMindEmbedViewer = XMindEmbedViewer;\n"],"names":["root","factory","exports","module","define","amd","self","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","Object","defineProperty","IframeEventChannelController","iFrameController","domain","channel","MessageChannel","eventIndex","handlers","iframe","getIframe","hasAttribute","Error","setAttribute","channelSetupPromise","_this","_a","addEventListener","port1","start","port1Handler","data","preventDefault","removeEventListener","eventDispatcher","bind","undefined","contentWindow","postMessage","port","port2","prototype","type","eventName","payload","forEach","handler","event","callback","includes","index","findIndex","fn","splice","emit","replyEvent","concat","message","IframeController","target","src","element","document","querySelector","HTMLIFrameElement","createElement","appendChild","setStyles","styles","_i","entries","_b","styleKey","style","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","XMindEmbedViewer","channel_controller_1","iframe_controller_1","args","internalState","sheets","zoomScale","currentSheetId","file","el","region","isPitchModeDisabled","iframeController","iframeEventChannelController","load","setZoomScale","setFitMap","switchSheet","sheetId","get","enumerable","configurable","JSON","parse","stringify"],"sourceRoot":""}